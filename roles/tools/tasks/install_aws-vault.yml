---
- import_tasks: install_github_files.yml
  vars:
    repo: 99designs/aws-vault
    copy:
      - {src: "aws-vault-linux-amd64", dest: "{{ bin_dir }}/aws-vault", mode: "0755"}

- name: Generate Completion Function
  command: "{{ bin_dir }}/aws-vault --completion-script-zsh"
  register: completion
  changed_when: false

- name: Write Completion Function
  copy:
    dest: "{{ data_dir }}/zsh/site-functions/_aws-vault"
    content: "{{ completion.stdout }}"
